extends ../layout/main

block globalVars
  - var metaTitle = 'Release Notes - Publish'

block content
  .hero.is-primary
    .hero-body
      .container.has-text-centered
        h2.subtitle.is-3 Publish Release Notes

  .section
    .container.has-text-centered
      if err
        .message
          .message-body
            .subtitle.is-5 Release Notes Validation failed.
            p #{err.message}

      .card.is-inline-block
        if !user.username
          form(method='post' action='/publish-claim-username')
            .card-content
              h3.subtitle Claim username
              .field.has-text-left
                label.label Username
                p.control
                  input.input(
                    type='text' autocomplete='username' name='username'
                    value=(form && form.username) placeholder='Pick an username' required
                  )
                  if errors && errors.username
                    .help.is-danger= errors.username.msg
                  .help Your unique username (only numbers, letters and dashes)
                  .help release-notes.com/<b>@your-name</b>
            .card-content
              .field
                p.control
                  input.button.is-dark.is-fullwidth(type='submit' value="Let's go")
          hr
        form(method='post' enctype='multipart/form-data' action='/publish')
          .card-content
            .field.has-text-left
              label.label Release Notes Name
              p.control
                input.input(
                  type='text' value=(form && form.name) autocomplete='name' name='name'
                  placeholder="Unique name of the release notes"
                  class=(errors && errors.name && 'is-danger')
                  disabled=!user.username
                )
                if errors && errors.name
                  span.help.is-danger= errors.name.msg
            .field.has-text-left
              label.label Release Notes File
              p.control
                input.input(
                  name='release-notes' type='file' required class=(errors && errors.file && 'is-danger')
                  disabled=!user.username
                )
                if errors && errors.file
                  span.help.is-danger= errors.file.msg

          .card-content
            .field
              p.control
                input.button.is-primary.is-fullwidth(type='submit' value='Publish' disabled=!user.username)
