extends ../layout/dashboard

append globalVars
  - var metaTitle = 'Release Notes - Organizations'
  - var pageSubtitle = 'My Organizations'
  - var activeTab = 'organizations'
  - var pageCls = 'organizations-page'

block pageContent
  .columns
    .column
      if !organizations || !organizations.length
        .message
          .message-body
            p You have not organizations, yet.
      else
        table.table.is-fullwidth
          tr
            th Organization
            th
            th
            th
          each organization in organizations
            tr
              td
                a(href=`/@${organization.name}`)
                  strong #{organization.name}
              td
                if organization.name === user.username
                  span.tag.is-primary.is-rounded Account
                else
                  span.tag.is-rounded Owner
              td
              td
                span.icon.is-large(title="Members")
                  i.mdi !{mdi('account-multiple')}
                  span &nbsp;&nbsp;#{organization.members && organization.members.length}
                a.button(href=`/organizations/@${organization.name}` title="Edit Organization")
                  span.icon
                    i.mdi !{mdi('settings')}


append content
  .hero.is-light
    .hero-body.has-text-centered
      .container
        .is-inline-block.has-text-left
          if user.username
            form(method='post' action='/organizations/new')
              h3.subtitle Create new Organization
              .field.has-addons
                .control
                  input.input(type='text' name='name' value=(form && form.name) placeholder="org-awesome")
                  if errors && errors.name
                    .help.is-danger= errors.name.msg
                  .help.has-text-grey Unique organization name (only numbers, letters and dashes)
                  .help.has-text-grey Your name on release-notes.com/<b>@org-awesome</b>
                .control
                  input.button.is-primary.is-fullwidth(type='submit' value='Create Organization')
          else
            form(method='post' action='/organizations/claim-username')
              h3.subtitle Claim Username
              h6.subtitle.is-6.
                In order to create or join organizations, you need to setup an username.
              .field.has-addons
                .control
                  input.input(type='text' name='username' value=(form && form.username) placeholder="Pick an username")
                  if errors && errors.username
                    .help.is-danger= errors.username.msg
                  .help.has-text-grey Your unique username (only numbers, letters and dashes)
                  .help.has-text-grey Your name on release-notes.com/<b>@org-awesome</b>
                .control
                  input.button.is-primary.is-fullwidth(type='submit' value='Claim Username')
